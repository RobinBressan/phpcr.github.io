<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="PHPDoctor 2RC4 (http://peej.github.com/phpdoctor/)">
<meta name="when" content="Tue, 27 Mar 2012 06:17:41 +0000">

<link rel="stylesheet" type="text/css" href="../../stylesheet.css">
<link rel="start" href="../../overview-summary.html">

<title>VersionManagerInterface (PHPCR API)</title>

</head>
<body id="definition" onload="parent.document.title=document.title;">

<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="../../phpcr/version/package-summary.html">Namespace</a></li>
<li class="active">Class</li>
<li><a href="../../phpcr/version/package-tree.html">Tree</a></li>
<li><a href="../../overview-files.html">Files</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../todo-list.html">Todo</a></li>
<li><a href="../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../index.html" target="_top">Frames</a>
<a href="../../phpcr/version/versionmanagerinterface.html" target="_top">No frames</a>
</div>
<div class="small_links">
Summary: <a href="#summary_field">Field</a> | <a href="#summary_method">Method</a> | <a href="#summary_constr">Constr</a>
Detail: <a href="#detail_field">Field</a> | <a href="#detail_method">Method</a> | <a href="#summary_constr">Constr</a>
</div>
<hr>

<div class="qualifiedName">PHPCR\Version\VersionManagerInterface</div>
<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line44" class="location">PHPCR/Version/VersionManagerInterface.php at line 44</a>

<h1>Interface VersionManagerInterface</h1>

<pre class="tree"><strong>VersionManagerInterface</strong><br /></pre>

<hr>

<p class="signature">public  interface <strong>VersionManagerInterface</strong></p>

<div class="comment" id="overview_description"><p>The VersionManager object is accessed via
WorkspaceInterface::getVersionManager(). It provides methods for:</p>
<ul>
<li>Version graph functionality (version history, base version, successors
predecessors)</li>
<li>Basic version operations (checkin, checkout, checkpoint)</li>
<li>Restore feature</li>
<li>Label feature</li>
<li>Merge feature</li>
<li>Configuration feature</li>
</ul>
<p>- Activity feature</p></div>

<dl>
<dt>Subpackage:</dt>
<dd>interfaces</dd>
<dt>Api.</dt>
</dl>
<hr>

<table id="summary_method">
<tr><th colspan="2">Method Summary</th></tr>
<tr>
<td class="type"> void</td>
<td class="description"><p class="name"><a href="#cancelMerge()">cancelMerge</a>(string absPath, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> version)</p><p class="description">Cancels the merge process with respect to the node at absPath and the
specified version.
</p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/version/versioninterface.html">VersionInterface</a></td>
<td class="description"><p class="name"><a href="#checkin()">checkin</a>(string absPath)</p><p class="description">Creates for the versionable node at absPath a new version with a system
generated version name and returns that version (which will be the new
base version of this node). </p></td>
</tr>
<tr>
<td class="type"> void</td>
<td class="description"><p class="name"><a href="#checkout()">checkout</a>(string absPath)</p><p class="description">Sets the versionable node at $absPath to checked-out status by setting
its jcr:isCheckedOut property to true. </p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/version/versioninterface.html">VersionInterface</a></td>
<td class="description"><p class="name"><a href="#checkpoint()">checkpoint</a>(string absPath)</p><p class="description">Performs a checkin() followed by a checkout() on the versionable node at
$absPath.
</p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/nodeinterface.html">NodeInterface</a></td>
<td class="description"><p class="name"><a href="#createActivity()">createActivity</a>(string title)</p><p class="description">This method creates a new nt:activity at an implementation-determined
location in the /jcr:system/jcr:activities subgraph.
</p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/nodeinterface.html">NodeInterface</a></td>
<td class="description"><p class="name"><a href="#createConfiguration()">createConfiguration</a>(string absPath, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> baseline)</p><p class="description">Calling createConfiguration on the node N at absPath creates, in the
configuration storage, a new nt:configuration node whose root is N. </p></td>
</tr>
<tr>
<td class="type"> void</td>
<td class="description"><p class="name"><a href="#doneMerge()">doneMerge</a>(string absPath, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> version)</p><p class="description">Completes the merge process with respect to the node at absPath and the
specified version.
</p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/nodeinterface.html">NodeInterface</a></td>
<td class="description"><p class="name"><a href="#getActivity()">getActivity</a>()</p><p class="description">Returns the node representing the current activity or null if there is no
current activity.</p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/version/versioninterface.html">VersionInterface</a></td>
<td class="description"><p class="name"><a href="#getBaseVersion()">getBaseVersion</a>(string absPath)</p><p class="description">Returns the current base version of the versionable node at absPath.</p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/version/versionhistoryinterface.html">VersionHistoryInterface</a></td>
<td class="description"><p class="name"><a href="#getVersionHistory()">getVersionHistory</a>(string absPath)</p><p class="description">Returns the VersionHistory object of the node at $absPath. </p></td>
</tr>
<tr>
<td class="type"> boolean</td>
<td class="description"><p class="name"><a href="#isCheckedOut()">isCheckedOut</a>(string absPath)</p><p class="description">Check whether the node at path is checked out.
</p></td>
</tr>
<tr>
<td class="type"> Iterator</td>
<td class="description"><p class="name"><a href="#merge()">merge</a>(<a href="../../phpcr/nodeinterface.html">NodeInterface</a> source, string srcWorkspace, boolean bestEffort, boolean isShallow)</p><p class="description">If an nt:activity Node is given:This method merges the changes that were made under the specified
activity into the current workspace.
</p></td>
</tr>
<tr>
<td class="type"> void</td>
<td class="description"><p class="name"><a href="#removeActivity()">removeActivity</a>(<a href="../../phpcr/nodeinterface.html">NodeInterface</a> activityNode)</p><p class="description">This method removes the given $activityNode.
</p></td>
</tr>
<tr>
<td class="type"> void</td>
<td class="description"><p class="name"><a href="#restore()">restore</a>(boolean removeExisting, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> version, string absPath)</p><p class="description">Attempt to restore an old version of a node.
</p></td>
</tr>
<tr>
<td class="type"> void</td>
<td class="description"><p class="name"><a href="#restoreByLabel()">restoreByLabel</a>(string absPath, string versionLabel, boolean removeExisting)</p><p class="description">Restores the version of the node at absPath with the specified version
label. </p></td>
</tr>
<tr>
<td class="type"> <a href="../../phpcr/nodeinterface.html">NodeInterface</a></td>
<td class="description"><p class="name"><a href="#setActivity()">setActivity</a>(<a href="../../phpcr/nodeinterface.html">NodeInterface</a> activity)</p><p class="description">This method is called by the client to set the current activity on the
session from which this version manager has been obtained. </p></td>
</tr>
</table>

<h2 id="detail_method">Method Detail</h2>
<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line557" class="location">PHPCR/Version/VersionManagerInterface.php at line 557</a>

<h3 id="cancelMerge()">cancelMerge</h3>
<code class="signature">public  void <strong>cancelMerge</strong>(string absPath, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> version)</code>
<div class="details">
<p>Cancels the merge process with respect to the node at absPath and the
specified version.</p><p>See doneMerge(string, Version) for a full explanation. Also see
merge(string, string, boolean) for more details.</p><p>If successful, these changes are dispatched immediately, there is no
need to call save.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dd>version - a version referred to by the jcr:mergeFailed property of the node at absPath.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/version/versionexception.html">\PHPCR\Version\VersionException</a> - if the version specified is not among those referenced in the jcr:mergeFailed property of the node at absPath or if the node is currently checked-in.</dd>
<dd>\PHPCR\InvalidItemStateExceptionif - there are unsaved changes pending on the node at absPath.</dd>
<dd>\PHPCR\UnsupportedRepositoryOperationExceptionif - the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line92" class="location">PHPCR/Version/VersionManagerInterface.php at line 92</a>

<h3 id="checkin()">checkin</h3>
<code class="signature">public  <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> <strong>checkin</strong>(string absPath)</code>
<div class="details">
<p>Creates for the versionable node at absPath a new version with a system
generated version name and returns that version (which will be the new
base version of this node). Sets the jcr:checkedOut property to false
thus putting the node into the checked-in state. This means that the node
and its connected non-versionable subgraph become read-only. A node's
connected non-versionable subgraph is the set of non-versionable descendant
nodes reachable from that node through child links without encountering
any versionable nodes. In other words, the read-only status flows down
from the checked-in node along every child link until either a versionable
node is encountered or an item with no children is encountered. In a
system that supports only simple versioning the connected non-versionable
subgraph will be equivalent to the whole subgraph, since simple-versionable
nodes cannot have simple-versionable descendants.</p><p>Read-only status means that an item cannot be altered by the client using
standard API methods (addNode, setProperty, etc.). The only exceptions to
this rule are the restore(), restoreByLabel(), merge() and Node::update()
operations; these do not respect read-only status due to check-in. Note
that remove of a read-only node is possible, as long as its parent is not
read-only (since removal is an alteration of the parent node).</p><p>If this node is already checked-in, this method has no effect but returns
the current base version of this node.</p><p>If checkin succeeds, the change to the jcr:isCheckedOut property is
dispatched immediately.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - an absolute path.</dd>
<dt>Returns:</dt>
<dd>the created version.</dd>
<dt>Throws:</dt>
<dd>\PHPCR\Verson\VersionException - if jcr:predecessors does not contain at least one value or if a child item of the node at absPath has an OnParentVersion status of ABORT. This includes the case where an unresolved merge failure exists on the node, as indicated by the presence of a jcr:mergeFailed property.</dd>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - If the node at $absPath is not versionable.</dd>
<dd><a href="../../phpcr/invaliditemstateexception.html">\PHPCR\InvalidItemStateException</a> - If unsaved changes exist on the node at $absPath.</dd>
<dd><a href="../../phpcr/lock/lockexception.html">\PHPCR\Lock\LockException</a> - if a lock prevents the operation.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - If another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line123" class="location">PHPCR/Version/VersionManagerInterface.php at line 123</a>

<h3 id="checkout()">checkout</h3>
<code class="signature">public  void <strong>checkout</strong>(string absPath)</code>
<div class="details">
<p>Sets the versionable node at $absPath to checked-out status by setting
its jcr:isCheckedOut property to true. Under full versioning it also sets
the jcr:predecessors property to be a reference to the current base
version (the same value as held in jcr:baseVersion).</p><p>This method puts the node into the checked-out state, making it and its
connected non-versionable subgraph no longer read-only (see checkin() for
an explanation of the term "connected non-versionable subgraph". Under
simple versioning this will simply be the whole subgraph).</p><p>If successful, these changes are persisted immediately, there is no need
to call save.</p><p>If this node is already checked-out, this method has no effect.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - an absolute path.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - If the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/lock/lockexception.html">\PHPCR\Lock\LockException</a> - if a lock prevents the checkout.</dd>
<dd><a href="../../phpcr/version/activityviolationexception.html">\PHPCR\Version\ActivityViolationException</a> - If the checkout conflicts with the activity present on the current session.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - If another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line148" class="location">PHPCR/Version/VersionManagerInterface.php at line 148</a>

<h3 id="checkpoint()">checkpoint</h3>
<code class="signature">public  <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> <strong>checkpoint</strong>(string absPath)</code>
<div class="details">
<p>Performs a checkin() followed by a checkout() on the versionable node at
$absPath.</p><p>If this node is already checked-in, this method is equivalent to checkout().</p><dl>
<dt>Parameters:</dt>
<dd>absPath - an absolute path.</dd>
<dt>Returns:</dt>
<dd>the created version.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/version/versionexception.html">\PHPCR\Version\VersionException</a> - if a child item of the node at absPath has an OnParentVersion of ABORT. This includes the case where an unresolved merge failure exists on the node, as indicated by the presence of the jcr:mergeFailed.</dd>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/invaliditemstateexception.html">\PHPCR\InvalidItemStateException</a> - if there are unsaved changes pending on the node at absPath.</dd>
<dd><a href="../../phpcr/lock/lockexception.html">\PHPCR\Lock\LockException</a> - if a lock prevents the operation.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line640" class="location">PHPCR/Version/VersionManagerInterface.php at line 640</a>

<h3 id="createActivity()">createActivity</h3>
<code class="signature">public  <a href="../../phpcr/nodeinterface.html">NodeInterface</a> <strong>createActivity</strong>(string title)</code>
<div class="details">
<p>This method creates a new nt:activity at an implementation-determined
location in the /jcr:system/jcr:activities subgraph.</p><p>The repository may, but is not required to, use the title as a hint for
what to name the new activity node. The new activity Node is returned.</p><p>The new node is dispatched immediately and does not require a save.</p><dl>
<dt>Parameters:</dt>
<dd>title - The tilte of the activity to be created.</dd>
<dt>Returns:</dt>
<dd>the new activity Node.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the repository does not support activities.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line586" class="location">PHPCR/Version/VersionManagerInterface.php at line 586</a>

<h3 id="createConfiguration()">createConfiguration</h3>
<code class="signature">public  <a href="../../phpcr/nodeinterface.html">NodeInterface</a> <strong>createConfiguration</strong>(string absPath, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> baseline)</code>
<div class="details">
<p>Calling createConfiguration on the node N at absPath creates, in the
configuration storage, a new nt:configuration node whose root is N. A
reference to N is recorded in the jcr:root property of the new
configuration, and a reference to the new configuration is recorded in
the jcr:configuration property of N.</p><p>If the specified baseline is null, a new version history is created to
store baselines of the new configuration, and the jcr:baseVersion of the
new configuration references the root of the new version history. If the
specified baseline is not null, the jcr:baseVersion of the new
configuration references the specified baseline.</p><p>The changes are persisted immediately, a save is not required.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dd>baseline - a Version</dd>
<dt>Returns:</dt>
<dd>a new nt:configuration node</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if N is not versionable.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line527" class="location">PHPCR/Version/VersionManagerInterface.php at line 527</a>

<h3 id="doneMerge()">doneMerge</h3>
<code class="signature">public  void <strong>doneMerge</strong>(string absPath, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> version)</code>
<div class="details">
<p>Completes the merge process with respect to the node at absPath and the
specified version.</p><p>When the merge(string, string, boolean) method is called on a node, every
versionable node in that subgraph is compared with its corresponding node
in the indicated other workspace and a "merge test result" is determined
indicating one of the following:</p><p><ol>
<li>
This node will be updated to the state of its correspondee (if the
base version of the correspondee is more recent in terms of version
history)
</li><li>
This node will be left alone (if this node's base version is more
recent in terms of version history).
</li><li>
This node will be marked as having failed the merge test (if this
node's base version is on a different branch of the version history
from the base version of its corresponding node in the other
workspace, thus preventing an automatic determination of which is more
recent).
</li>
</ol></p><p>(See merge() for more details)</p><p>In the last case the merge of the non-versionable subgraph (the "content")
of this node must be done by the application (for example, by providing a
merge tool for the user).</p><p>Additionally, once the content of the nodes has been merged, their version
graph branches must also be merged. The JCR versioning system provides for
this by keeping a record, for each versionable node that fails the merge
test, of the base version of the corresponding node that caused the merge
failure. This record is kept in the jcr:mergeFailed property of this node.
After a merge, this property will contain one or more (if multiple merges
have been performed) REFERENCEs that point to the "offending versions".</p><p>To complete the merge process, the client calls doneMerge(Version v)
passing the version object referred to be the jcr:mergeFailed property
that the client wishes to connect to this node in the version graph. This
has the effect of moving the reference to the indicated version from the
jcr:mergeFailed property of this node to the jcr:predecessors.</p><p>If the client chooses not to connect this node to a particular version
referenced in the jcr:mergeFailed property, he calls cancelMerge(String,
Version).
This has the effect of removing the reference to the specified version
from jcr:mergeFailed without adding it to jcr:predecessors.</p><p>Once the last reference in jcr:mergeFailed has been either moved to
jcr:predecessors (with doneMerge) or just removed from jcr:mergeFailed
(with cancelMerge) the jcr:mergeFailed property is automatically removed,
thus enabling this node to be checked-in, creating a new version (note
that before the jcr:mergeFailed is removed, its OnParentVersion setting of
ABORT prevents checkin). This new version will have a predecessor
connection to each version for which doneMerge was called, thus joining
those branches of the version graph.</p><p>If successful, these changes are dispatched immediately, there is no need
to call save.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dd>version - a version referred to by the jcr:mergeFailed property of the node at absPath.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/version/versionexception.html">\PHPCR\Version\VersionException</a> - if the version specified is not among those referenced in this node's jcr:mergeFailed or if the node is currently checked-in.</dd>
<dd><a href="../../phpcr/invaliditemstateexception.html">\PHPCR\InvalidItemStateException</a> - if there are unsaved changes pending on the node at absPath.</dd>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line619" class="location">PHPCR/Version/VersionManagerInterface.php at line 619</a>

<h3 id="getActivity()">getActivity</h3>
<code class="signature">public  <a href="../../phpcr/nodeinterface.html">NodeInterface</a> <strong>getActivity</strong>()</code>
<div class="details">
<p>Returns the node representing the current activity or null if there is no
current activity.</p><dl>
<dt>Returns:</dt>
<dd>An nt:activity node or null.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the repository does not support activities.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line208" class="location">PHPCR/Version/VersionManagerInterface.php at line 208</a>

<h3 id="getBaseVersion()">getBaseVersion</h3>
<code class="signature">public  <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> <strong>getBaseVersion</strong>(string absPath)</code>
<div class="details">
<p>Returns the current base version of the versionable node at absPath.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dt>Returns:</dt>
<dd>a Version object.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line192" class="location">PHPCR/Version/VersionManagerInterface.php at line 192</a>

<h3 id="getVersionHistory()">getVersionHistory</h3>
<code class="signature">public  <a href="../../phpcr/version/versionhistoryinterface.html">VersionHistoryInterface</a> <strong>getVersionHistory</strong>(string absPath)</code>
<div class="details">
<p>Returns the VersionHistory object of the node at $absPath. This object
provides access to the nt:versionHistory node holding this node's
versions.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dt>Returns:</dt>
<dd>a VersionHistory object</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - If another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line174" class="location">PHPCR/Version/VersionManagerInterface.php at line 174</a>

<h3 id="isCheckedOut()">isCheckedOut</h3>
<code class="signature">public  boolean <strong>isCheckedOut</strong>(string absPath)</code>
<div class="details">
<p>Check whether the node at path is checked out.</p><p>Returns true if the node at $absPath is either</p>
<ul>
<li>versionable (full or simple) and currently checked-out,</li>
<li>non-versionable and its nearest versionable ancestor is checked-out or</li>
<li>non-versionable and it has no versionable ancestor.</li>
</ul>
<p>Returns false if the node at $absPath is either</p><p>- versionable (full or simple) and currently checked-in or
- non-versionable and its nearest versionable ancestor is checked-in.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dt>Returns:</dt>
<dd>True, if the node identified by the given path is checked out, else false.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if an error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line443" class="location">PHPCR/Version/VersionManagerInterface.php at line 443</a>

<h3 id="merge()">merge</h3>
<code class="signature">public  Iterator <strong>merge</strong>(<a href="../../phpcr/nodeinterface.html">NodeInterface</a> source, string srcWorkspace, boolean bestEffort, boolean isShallow)</code>
<div class="details">
<p>If an nt:activity Node is given:</p><p>This method merges the changes that were made under the specified
activity into the current workspace.</p><p>An activity A will be associated with a set of versions through the
jcr:activity reference of each version node in the set. We call each
such associated version a member of A.</p><p>For each version history H that contains one or more members of A, one
such member will be the latest member of A in H. The latest member of A
in H is the version in H that is a member of A and that has no successor
versions (to any degree) that are also members of A.</p><p>The set of versions that are the latest members of A in their respective
version histories is called the change set of A. It fully describes the
changes made under the activity A.</p><p>This method performs a shallow merge into the current workspace of each
version in the change set of the activity specified by activityNode. If
there is no corresponding node in this workspace for a given member of
the change set, that member is ignored.</p><p>
If an absolute path is given:</p><p>This method can be thought of as a version-sensitive update.</p><p>If isShallow is true, it tests the node at absPath against its
corresponding node in srcWorkspace with respect to the relation between
their respective base versions and either updates the node in question
or not, depending on the outcome of the test.</p><p>If isShallow is false, this method recursively tests each versionable
node in the subgraph as mentioned above.</p><p>If isShallow is true and this node is not versionable, then this method
returns and no changes are made.</p><p>A MergeException is thrown if bestEffort is false and a versionable node
is encountered whose corresponding node's base version is on a divergent
branch from the base version of the node at absPath.</p><p>This is a worksapce-write method and therefore any changes are dispatched
immediately.</p><p>This method returns an iterator over all versionable nodes in the
subgraph that received a merge result of fail. If bestEffort is false,
this iterator will be empty (since if merge returns successfully,
instead of throwing an exception, it will be because no failures were
encountered).
If bestEffort is true, this iterator will contain all nodes that received
a fail during the course of this merge operation.</p><p>
See the JCR specifications for more details on the behavior of this
method.</p><p>Note: The Java API defines this with multiple differing signatures.</p><dl>
<dt>Parameters:</dt>
<dd>source - an absolute path or an nt:activity node.</dd>
<dd>srcWorkspace - the name of the source workspace (optional if $source is a Node).</dd>
<dd>bestEffort - a boolean (optional if $source is a Node)</dd>
<dd>isShallow - a boolean (optional)</dd>
<dt>Returns:</dt>
<dd>implementing <b>SeekableIterator</b> and <b>Countable</b>. Keys are the Node names, values the corresponding NodeInterface instances that received a merge result of "fail" in the course of this operation.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/mergeexception.html">\PHPCR\MergeException</a> - - if bestEffort is false and a failed merge result is encountered.</dd>
<dd><a href="../../phpcr/invaliditemstateexception.html">\PHPCR\InvalidItemStateException</a> - if this session (not necessarily the node at absPath) has pending unsaved changes.</dd>
<dd><a href="../../phpcr/nosuchworkspaceexception.html">\PHPCR\NoSuchWorkspaceException</a> - if srcWorkspace does not exist.</dd>
<dd><a href="../../phpcr/accessdeniedexception.html">\PHPCR\AccessDeniedException</a> - if the current session does not have sufficient rights to perform the operation.</dd>
<dd><a href="../../phpcr/lock/lockexception.html">\PHPCR\Lock\LockException</a> - if a lock prevents the merge.</dd>
<dd><a href="../../phpcr/version/versionexception.html">\PHPCR\Version\VersionException</a> - if the specified node is not an nt:activity node.</dd>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if this operation is not supported by this implementation.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line657" class="location">PHPCR/Version/VersionManagerInterface.php at line 657</a>

<h3 id="removeActivity()">removeActivity</h3>
<code class="signature">public  void <strong>removeActivity</strong>(<a href="../../phpcr/nodeinterface.html">NodeInterface</a> activityNode)</code>
<div class="details">
<p>This method removes the given $activityNode.</p><p>The change is dispatched immediately and does not require a save.</p><dl>
<dt>Parameters:</dt>
<dd>activityNode - an activity Node</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the repository does not support activities.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line305" class="location">PHPCR/Version/VersionManagerInterface.php at line 305</a>

<h3 id="restore()">restore</h3>
<code class="signature">public  void <strong>restore</strong>(boolean removeExisting, <a href="../../phpcr/version/versioninterface.html">VersionInterface</a> version, string absPath)</code>
<div class="details">
<p>Attempt to restore an old version of a node.</p><p><em>If $absPath is given and $version is a version name:</em>
Restores the node at $absPath to the state defined by the version with
the specified version name ($version).
This method will work regardless of whether the node at absPath is
checked-in or not.</p><p>
<em>If $absPath is given and $version is a VersionInterface instance:
</em>
Restores the specified version to $absPath. There must be no existing
node at $absPath. If one exists, a VersionException is thrown.
There must be a parent node to the location at $absPath, otherwise a
PathNotFoundException is thrown.
If the would-be parent of the location $absPath is actually a property,
or if a node type restriction would be violated, then a
ConstraintViolationException is thrown.</p><p>
<em>If $version is VersionInterface instance:</em>
Restores the node in the current workspace that is the versionable node
of the specified version to the state reflected in that version.
This method ignores checked-in status.</p><p>
<em>If $version is an array of VersionInterface instances:</em>
Restores a set of versions at once. Used in cases where a "chicken and
egg" problem of mutually referring REFERENCE properties would prevent
the restore in any serial order.
The following restrictions apply to the set of versions specified: If S
is the set of versions being restored simultaneously,</p>
<ul>
<li>For every version V in S that corresponds to a missing node, there
must also be a parent of V in S.</li>
<li>S must contain at least one version that corresponds to an existing
node in the workspace.</li>
<li>No V in S can be a root version (jcr:rootVersion).
If any of these restrictions does not hold, the restore will fail
because the system will be unable to determine the path locations to
which one or more versions are to be restored. In this case a
VersionException is thrown.
The versionable nodes in the current workspace that correspond to the
versions being restored define a set of (one or more) subgraphs.</li>
</ul>
<p><em>If the restore succeeds the changes made are dispatched immediately;
</em>
there is no need to call save.</p><p>If an array of VersionInterface instances is restored, an identifier
collision occurs when the current workspace contains a node outside these
subgraphs that has the same identifier as one of the nodes that would be
introduced by the restore operation into one of these subgraphs.
Else, an identifier collision occurs when a node exists outside the
subgraph rooted at absPath with the same identifier as a node that would
be introduced by the restore operation into the affected subgraph.
The result in such a case is governed by the removeExisting flag. If
$removeExisting is true, then the incoming node takes precedence, and the
existing node (and its subgraph) is removed (if possible; otherwise a
RepositoryException is thrown). If $removeExisting is false, then an
ItemExistsException is thrown and no changes are made. Note that this
applies not only to cases where the restored node itself conflicts with
an existing node but also to cases where a conflict occurs with any node
that would be introduced into the workspace by the restore operation. In
particular, conflicts involving subnodes of the restored node that have
OnParentVersion settings of COPY or VERSION are also governed by the
$removeExisting flag.</p><p><b>Note:</b> The Java API defines this with multiple differing
signatures, you need to act accordingly in your implementation.</p><dl>
<dt>Parameters:</dt>
<dd>removeExisting - a boolean flag that governs what happens in case of an identifier collision</dd>
<dd>version - a version name, an an array of Version objects or a Version object</dd>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/version/versionexception.html">\PHPCR\Version\VersionException</a> - if the specified version does not have a corresponding node in the workspace this VersionManager has been created for or if an attempt is made to restore the root version (jcr:rootVersion).</dd>
<dd><a href="../../phpcr/itemexistsexception.html">\PHPCR\ItemExistsException</a> - if $removeExisting is false and an identifier collision occurs or a node exists at $absPath.</dd>
<dd><a href="../../phpcr/invaliditemstateexception.html">\PHPCR\InvalidItemStateException</a> - if this Session has pending unsaved changes.</dd>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if versioning is not supported.</dd>
<dd><a href="../../phpcr/lock/lockexception.html">\PHPCR\Lock\LockException</a> - if a lock prevents the restore.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line352" class="location">PHPCR/Version/VersionManagerInterface.php at line 352</a>

<h3 id="restoreByLabel()">restoreByLabel</h3>
<code class="signature">public  void <strong>restoreByLabel</strong>(string absPath, string versionLabel, boolean removeExisting)</code>
<div class="details">
<p>Restores the version of the node at absPath with the specified version
label. If this node is not versionable, an
UnsupportedRepositoryOperationException is thrown. If successful, the
change is persisted immediately and there is no need to call save.</p><p>This method will work regardless of whether the node at absPath is
checked-in or not.</p><p>An identifier collision occurs when a node exists outside the subgraph
rooted at this node with the same identifier as a node that would be
introduced by the restoreByLabel operation into the subgraph at this node.
The result in such a case is governed by the removeExisting flag. If
removeExisting is true, then the incoming node takes precedence, and the
existing node (and its subgraph) is removed (if possible; otherwise a
RepositoryException is thrown). If removeExisting is false, then a
ItemExistsException is thrown and no changes are made. Note that this
applies not only to cases where the restored node itself conflicts with
an existing node but also to cases where a conflict occurs with any node
that would be introduced into the workspace by the restore operation. In
particular, conflicts involving subnodes of the restored node that have
OnParentVersion settings of COPY or VERSION are also governed by the
removeExisting flag.</p><dl>
<dt>Parameters:</dt>
<dd>absPath - The absolute path to a node the privileges shall be fetched of.</dd>
<dd>versionLabel - a String</dd>
<dd>removeExisting - a boolean flag that governs what happens in case of an identifier collision.</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the node at absPath is not versionable.</dd>
<dd><a href="../../phpcr/version/versionexception.html">\PHPCR\Version\VersionException</a> - if the specified versionLabel does not exist in this node's version history.</dd>
<dd><a href="../../phpcr/itemexistsexception.html">\PHPCR\ItemExistsException</a> - if removeExisting is false and an identifier collision occurs.</dd>
<dd><a href="../../phpcr/lock/lockexception.html">\PHPCR\Lock\LockException</a> - if a lock prevents the restore.</dd>
<dd><a href="../../phpcr/invaliditemstateexception.html">\PHPCR\InvalidItemStateException</a> - if this Session (not necessarily the Node at absPath) has pending unsaved changes.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - If another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<a href="../../source/phpcr/version/versionmanagerinterface.php.html#line605" class="location">PHPCR/Version/VersionManagerInterface.php at line 605</a>

<h3 id="setActivity()">setActivity</h3>
<code class="signature">public  <a href="../../phpcr/nodeinterface.html">NodeInterface</a> <strong>setActivity</strong>(<a href="../../phpcr/nodeinterface.html">NodeInterface</a> activity)</code>
<div class="details">
<p>This method is called by the client to set the current activity on the
session from which this version manager has been obtained. Changing the
current activity is done by calling setActivity again. Cancelling the
current activity (so that the session has no current activity) is done
by calling setActivity(null). The activity Node is returned.</p><dl>
<dt>Parameters:</dt>
<dd>activity - an activity node</dd>
<dt>Returns:</dt>
<dd>the activity node</dd>
<dt>Throws:</dt>
<dd><a href="../../phpcr/unsupportedrepositoryoperationexception.html">\PHPCR\UnsupportedRepositoryOperationException</a> - if the repository does not support activities or if activity is not a nt:activity node.</dd>
<dd><a href="../../phpcr/repositoryexception.html">\PHPCR\RepositoryException</a> - if another error occurs.</dd>
<dt>Api.</dt>
</dl>
</div>

<hr>

<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="../../phpcr/version/package-summary.html">Namespace</a></li>
<li class="active">Class</li>
<li><a href="../../phpcr/version/package-tree.html">Tree</a></li>
<li><a href="../../overview-files.html">Files</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../todo-list.html">Todo</a></li>
<li><a href="../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../index.html" target="_top">Frames</a>
<a href="../../phpcr/version/versionmanagerinterface.html" target="_top">No frames</a>
</div>
<div class="small_links">
Summary: <a href="#summary_field">Field</a> | <a href="#summary_method">Method</a> | <a href="#summary_constr">Constr</a>
Detail: <a href="#detail_field">Field</a> | <a href="#detail_method">Method</a> | <a href="#summary_constr">Constr</a>
</div>
<hr>

<p id="footer">This document was generated by <a href="http://peej.github.com/phpdoctor/">PHPDoctor: The PHP Documentation Creator</a></p>

</body>

</html>