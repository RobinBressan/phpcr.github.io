<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="PHPDoctor 2RC4 (http://peej.github.com/phpdoctor/)">
<meta name="when" content="Tue, 26 Jul 2011 15:56:38 +0000">

<link rel="stylesheet" type="text/css" href="../../stylesheet.css">
<link rel="start" href="../../overview-summary.html">

<title>PHPCR/PropertyType.php (PHPCR API)</title>

</head>
<body id="file" onload="parent.document.title=document.title;">

<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../../overview-files.html">Files</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../todo-list.html">Todo</a></li>
<li><a href="../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../index.html" target="_top">Frames</a>
<a href="../../source/phpcr/propertytype.php.html" target="_top">No frames</a>
</div>
<hr>

<h1>PHPCR/PropertyType.php</h1>
<div class="comment" id="overview_description"><p>This file is part of the PHPCR API and was originally ported from the Java
JCR API to PHP by Karsten Dambekalns for the FLOW3 project.</p><p>Copyright 2008-2011 Karsten Dambekalns <karsten@typo3.org></p><p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p><p>http://www.apache.org/licenses/LICENSE-2.0</p><p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p></div>

<hr>

<a name="line1"></a><pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
<a name="line2"></a>&nbsp;
<a name="line3"></a><span style="color: #009933; font-style: italic;">/**
<a name="line4"></a> * This file is part of the PHPCR API and was originally ported from the Java
<a name="line5"></a> * JCR API to PHP by Karsten Dambekalns for the FLOW3 project.
<a name="line6"></a> *
<a name="line7"></a> * Copyright 2008-2011 Karsten Dambekalns &lt;karsten@typo3.org&gt;
<a name="line8"></a> *
<a name="line9"></a> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<a name="line10"></a> * you may not use this file except in compliance with the License.
<a name="line11"></a> * You may obtain a copy of the License at
<a name="line12"></a> *
<a name="line13"></a> *     http://www.apache.org/licenses/LICENSE-2.0
<a name="line14"></a> *
<a name="line15"></a> * Unless required by applicable law or agreed to in writing, software
<a name="line16"></a> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<a name="line17"></a> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<a name="line18"></a> * See the License for the specific language governing permissions and
<a name="line19"></a> * limitations under the License.
<a name="line20"></a> *
<a name="line21"></a> * @license http://www.apache.org/licenses/LICENSE-2.0 Apache Software License 2.0
<a name="line22"></a> * @link http://phpcr.github.com/
<a name="line23"></a>*/</span>
<a name="line24"></a>&nbsp;
<a name="line25"></a><span style="color: #000000; font-weight: bold;">namespace</span> PHPCR<span style="color: #339933;">;</span>
<a name="line26"></a>&nbsp;
<a name="line27"></a><span style="color: #009933; font-style: italic;">/**
<a name="line28"></a> * The property types supported by the JCR standard.
<a name="line29"></a> *
<a name="line30"></a> * - The &lt;b&gt;STRING&lt;/b&gt; property type is used to store strings.
<a name="line31"></a> * - &lt;b&gt;BINARY&lt;/b&gt; properties are used to store binary data.
<a name="line32"></a> * - The &lt;b&gt;LONG&lt;/b&gt; property type is used to store integers.
<a name="line33"></a> * - The &lt;b&gt;DECIMAL&lt;/b&gt; property type is used to store precise decimal numbers.
<a name="line34"></a> * - The &lt;b&gt;DOUBLE&lt;/b&gt; property type is used to store floating point numbers.
<a name="line35"></a> * - The &lt;b&gt;DATE&lt;/b&gt; property type is used to store time and date information. See 4.2.6.1 Date in the specification.
<a name="line36"></a> * - The &lt;b&gt;BOOLEAN&lt;/b&gt; property type is used to store boolean values.
<a name="line37"></a> * - A &lt;b&gt;NAME&lt;/b&gt; is a pairing of a namespace and a local name. When read, the namespace is mapped to the current prefix.
<a name="line38"></a> *   See 4.2.6.2 Name in the specification.
<a name="line39"></a> * - A &lt;b&gt;PATH&lt;/b&gt; property is an ordered list of path elements. A path element is a NAME with an optional index.
<a name="line40"></a> *   When read, the NAMEs within the path are mapped to their current prefix. A path may be absolute or relative.
<a name="line41"></a> *   See 4.2.6.3 Path in the specification.
<a name="line42"></a> * - A &lt;b&gt;REFERENCE&lt;/b&gt; property stores the identifier of a referenceable node (one having type mix:referenceable),
<a name="line43"></a> *   which must exist within the same workspace or session as the REFERENCE property. A REFERENCE property enforces this
<a name="line44"></a> *   referential integrity by preventing (in level 2 implementations) the removal of its target node.
<a name="line45"></a> *   See 4.2.6.4 Reference in the specification.
<a name="line46"></a> * - A &lt;b&gt;WEAKREFERENCE&lt;/b&gt; property stores the identifier of a referenceable node (one having type mix:referenceable).
<a name="line47"></a> * - A WEAKREFERENCE property does not enforce referential integrity. See 4.2.6.5 Weak Reference in the specification.
<a name="line48"></a> * - A &lt;b&gt;URI&lt;/b&gt; property is identical to STRING property except that it only accepts values that conform to the
<a name="line49"></a> *   syntax of a URI-reference as defined in RFC 3986. See also 4.2.6.6 URI in the specification.
<a name="line50"></a> * - &lt;b&gt;UNDEFINED&lt;/b&gt; can be used within a property definition (see 4.7.5 Property Definitions) to specify that the
<a name="line51"></a> *   property in question may be of any type. However, it cannot be the actual type of any property instance.
<a name="line52"></a> *   For example it will never be returned by PropertyInterface::getType() and (in level 2 implementations) it cannot be assigned
<a name="line53"></a> *   as the type when creating a new property.
<a name="line54"></a> *
<a name="line55"></a> * PHP Note on date formatting:
<a name="line56"></a> *   Since there is no formatting for milliseconds in PHP we construct the date formatting by cutting the microseconds
<a name="line57"></a> *   to 3 positions. Unfortunately this might cause an inacuracy of one millisecond in the worst case.
<a name="line58"></a> *
<a name="line59"></a> * @author Sebastian Kurf√ºrst &lt;sebastian@typo3.org&gt;
<a name="line60"></a> * @author Karsten Dambekalns &lt;karsten@typo3.org&gt;
<a name="line61"></a> * @package phpcr
<a name="line62"></a> * @api
<a name="line63"></a> */</span>
<a name="line64"></a>final <span style="color: #000000; font-weight: bold;">class</span> PropertyType
<a name="line65"></a><span style="color: #009900;">&#123;</span>
<a name="line66"></a>    <span style="color: #009933; font-style: italic;">/**#@+
<a name="line67"></a>     * @var integer
<a name="line68"></a>     */</span>
<a name="line69"></a>&nbsp;
<a name="line70"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line71"></a>     * This constant can be used within a property definition to specify that
<a name="line72"></a>     * the property in question may be of any type.
<a name="line73"></a>     *
<a name="line74"></a>     * However, it cannot be the actual type of any property instance. For
<a name="line75"></a>     * example, it will never be returned by Property#getType and it cannot be
<a name="line76"></a>     * assigned as the type when creating a new property.
<a name="line77"></a>     */</span>
<a name="line78"></a>    <span style="color: #000000; font-weight: bold;">const</span> UNDEFINED <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
<a name="line79"></a>&nbsp;
<a name="line80"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line81"></a>     * The STRING property type is used to store strings.
<a name="line82"></a>     */</span>
<a name="line83"></a>    <span style="color: #000000; font-weight: bold;">const</span> STRING <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span>
<a name="line84"></a>&nbsp;
<a name="line85"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line86"></a>     * BINARY properties are used to store binary data.
<a name="line87"></a>     */</span>
<a name="line88"></a>    <span style="color: #000000; font-weight: bold;">const</span> BINARY <span style="color: #339933;">=</span> <span style="color: #cc66cc;">2</span><span style="color: #339933;">;</span>
<a name="line89"></a>&nbsp;
<a name="line90"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line91"></a>     * The LONG property type is used to store integers.
<a name="line92"></a>     */</span>
<a name="line93"></a>    <span style="color: #000000; font-weight: bold;">const</span> LONG <span style="color: #339933;">=</span> <span style="color: #cc66cc;">3</span><span style="color: #339933;">;</span>
<a name="line94"></a>&nbsp;
<a name="line95"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line96"></a>     * The DOUBLE property type is used to store floating point numbers.
<a name="line97"></a>     */</span>
<a name="line98"></a>    <span style="color: #000000; font-weight: bold;">const</span> DOUBLE <span style="color: #339933;">=</span> <span style="color: #cc66cc;">4</span><span style="color: #339933;">;</span>
<a name="line99"></a>&nbsp;
<a name="line100"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line101"></a>     * The DATE property type is used to store time and date information.
<a name="line102"></a>     */</span>
<a name="line103"></a>    <span style="color: #000000; font-weight: bold;">const</span> <a href="http://www.php.net/date"><span style="color: #990000;">DATE</span></a> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">5</span><span style="color: #339933;">;</span>
<a name="line104"></a>&nbsp;
<a name="line105"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line106"></a>     * The BOOLEAN property type is used to store boolean values.
<a name="line107"></a>     */</span>
<a name="line108"></a>    <span style="color: #000000; font-weight: bold;">const</span> BOOLEAN <span style="color: #339933;">=</span> <span style="color: #cc66cc;">6</span><span style="color: #339933;">;</span>
<a name="line109"></a>&nbsp;
<a name="line110"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line111"></a>     * A NAME is a pairing of a namespace and a local name. When read, the
<a name="line112"></a>     * namespace is mapped to the current prefix.
<a name="line113"></a>     */</span>
<a name="line114"></a>    <span style="color: #000000; font-weight: bold;">const</span> NAME <span style="color: #339933;">=</span> <span style="color: #cc66cc;">7</span><span style="color: #339933;">;</span>
<a name="line115"></a>&nbsp;
<a name="line116"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line117"></a>     * A PATH property is an ordered list of path elements. A path element is a
<a name="line118"></a>     * NAME with an optional index. When read, the NAMEs within the path are
<a name="line119"></a>     * mapped to their current prefix. A path may be absolute or relative.
<a name="line120"></a>     */</span>
<a name="line121"></a>    <span style="color: #000000; font-weight: bold;">const</span> PATH <span style="color: #339933;">=</span> <span style="color: #cc66cc;">8</span><span style="color: #339933;">;</span>
<a name="line122"></a>&nbsp;
<a name="line123"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line124"></a>     * A REFERENCE property stores the identifier of a referenceable node (one
<a name="line125"></a>     * having type mix:referenceable), which must exist within the same
<a name="line126"></a>     * workspace or session as the REFERENCE property. A REFERENCE property
<a name="line127"></a>     * enforces this referential integrity by preventing the removal of its
<a name="line128"></a>     * target node.
<a name="line129"></a>     */</span>
<a name="line130"></a>    <span style="color: #000000; font-weight: bold;">const</span> REFERENCE <span style="color: #339933;">=</span> <span style="color: #cc66cc;">9</span><span style="color: #339933;">;</span>
<a name="line131"></a>&nbsp;
<a name="line132"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line133"></a>     * A WEAKREFERENCE property stores the identifier of a referenceable node
<a name="line134"></a>     * (one having type mix:referenceable). A WEAKREFERENCE property does not
<a name="line135"></a>     * enforce referential integrity.
<a name="line136"></a>     */</span>
<a name="line137"></a>    <span style="color: #000000; font-weight: bold;">const</span> WEAKREFERENCE <span style="color: #339933;">=</span> <span style="color: #cc66cc;">10</span><span style="color: #339933;">;</span>
<a name="line138"></a>&nbsp;
<a name="line139"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line140"></a>     * A URI property is identical to STRING property except that it only
<a name="line141"></a>     * accepts values that conform to the syntax of a URI-reference as defined
<a name="line142"></a>     * in RFC 3986.
<a name="line143"></a>     */</span>
<a name="line144"></a>    <span style="color: #000000; font-weight: bold;">const</span> URI <span style="color: #339933;">=</span> <span style="color: #cc66cc;">11</span><span style="color: #339933;">;</span>
<a name="line145"></a>&nbsp;
<a name="line146"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line147"></a>     * The DECIMAL property type is used to store precise decimal numbers.
<a name="line148"></a>     */</span>
<a name="line149"></a>    <span style="color: #000000; font-weight: bold;">const</span> DECIMAL <span style="color: #339933;">=</span> <span style="color: #cc66cc;">12</span><span style="color: #339933;">;</span>
<a name="line150"></a>&nbsp;
<a name="line151"></a>    <span style="color: #009933; font-style: italic;">/**#@-*/</span>
<a name="line152"></a>&nbsp;
<a name="line153"></a>    <span style="color: #009933; font-style: italic;">/**#@+
<a name="line154"></a>     * @var string
<a name="line155"></a>     */</span>
<a name="line156"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line157"></a>     * String constant for type name as used in serialization.
<a name="line158"></a>     */</span>
<a name="line159"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_UNDEFINED <span style="color: #339933;">=</span> <span style="color: #0000ff;">'undefined'</span><span style="color: #339933;">;</span>
<a name="line160"></a>&nbsp;
<a name="line161"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line162"></a>     * String constant for type name as used in serialization.
<a name="line163"></a>     */</span>
<a name="line164"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_STRING <span style="color: #339933;">=</span> <span style="color: #0000ff;">'String'</span><span style="color: #339933;">;</span>
<a name="line165"></a>&nbsp;
<a name="line166"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line167"></a>     * String constant for type name as used in serialization.
<a name="line168"></a>     */</span>
<a name="line169"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_BINARY <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Binary'</span><span style="color: #339933;">;</span>
<a name="line170"></a>&nbsp;
<a name="line171"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line172"></a>     * String constant for type name as used in serialization.
<a name="line173"></a>     */</span>
<a name="line174"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_LONG <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Long'</span><span style="color: #339933;">;</span>
<a name="line175"></a>&nbsp;
<a name="line176"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line177"></a>     * String constant for type name as used in serialization.
<a name="line178"></a>     */</span>
<a name="line179"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_DOUBLE <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Double'</span><span style="color: #339933;">;</span>
<a name="line180"></a>&nbsp;
<a name="line181"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line182"></a>     * String constant for type name as used in serialization.
<a name="line183"></a>     */</span>
<a name="line184"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_DATE <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Date'</span><span style="color: #339933;">;</span>
<a name="line185"></a>&nbsp;
<a name="line186"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line187"></a>     * String constant for type name as used in serialization.
<a name="line188"></a>     */</span>
<a name="line189"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_BOOLEAN <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Boolean'</span><span style="color: #339933;">;</span>
<a name="line190"></a>&nbsp;
<a name="line191"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line192"></a>     * String constant for type name as used in serialization.
<a name="line193"></a>     */</span>
<a name="line194"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_NAME <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Name'</span><span style="color: #339933;">;</span>
<a name="line195"></a>&nbsp;
<a name="line196"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line197"></a>     * String constant for type name as used in serialization.
<a name="line198"></a>     */</span>
<a name="line199"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_PATH <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Path'</span><span style="color: #339933;">;</span>
<a name="line200"></a>&nbsp;
<a name="line201"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line202"></a>     * String constant for type name as used in serialization.
<a name="line203"></a>     */</span>
<a name="line204"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_REFERENCE <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Reference'</span><span style="color: #339933;">;</span>
<a name="line205"></a>&nbsp;
<a name="line206"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line207"></a>     * String constant for type name as used in serialization.
<a name="line208"></a>     */</span>
<a name="line209"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_WEAKREFERENCE <span style="color: #339933;">=</span> <span style="color: #0000ff;">'WeakReference'</span><span style="color: #339933;">;</span>
<a name="line210"></a>&nbsp;
<a name="line211"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line212"></a>     * String constant for type name as used in serialization.
<a name="line213"></a>     */</span>
<a name="line214"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_URI<span style="color: #339933;">=</span> <span style="color: #0000ff;">'URI'</span><span style="color: #339933;">;</span>
<a name="line215"></a>&nbsp;
<a name="line216"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line217"></a>     * String constant for type name as used in serialization.
<a name="line218"></a>     */</span>
<a name="line219"></a>    <span style="color: #000000; font-weight: bold;">const</span> TYPENAME_DECIMAL <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Decimal'</span><span style="color: #339933;">;</span>
<a name="line220"></a>&nbsp;
<a name="line221"></a>    <span style="color: #009933; font-style: italic;">/**#@-*/</span>
<a name="line222"></a>&nbsp;
<a name="line223"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line224"></a>     * Make instantiation impossible...
<a name="line225"></a>     *
<a name="line226"></a>     * @return void
<a name="line227"></a>     */</span>
<a name="line228"></a>    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">function</span> __construct<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
<a name="line229"></a>    <span style="color: #009900;">&#123;</span>
<a name="line230"></a>    <span style="color: #009900;">&#125;</span>
<a name="line231"></a>&nbsp;
<a name="line232"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line233"></a>     * Returns the name of the specified type, as used in serialization.
<a name="line234"></a>     *
<a name="line235"></a>     * @param integer $type type the property type
<a name="line236"></a>     * @return string  name of the specified type
<a name="line237"></a>     *
<a name="line238"></a>     * @throws \InvalidArgumentException if the given type is unknown.
<a name="line239"></a>     * @api
<a name="line240"></a>     */</span>
<a name="line241"></a>    static <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> nameFromValue<span style="color: #009900;">&#40;</span><span style="color: #000088;">$type</span><span style="color: #009900;">&#41;</span>
<a name="line242"></a>    <span style="color: #009900;">&#123;</span>
<a name="line243"></a>        <span style="color: #b1b100;">switch</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/intval"><span style="color: #990000;">intval</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$type</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line244"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">UNDEFINED</span> <span style="color: #339933;">:</span>
<a name="line245"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_UNDEFINED</span><span style="color: #339933;">;</span>
<a name="line246"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">STRING</span> <span style="color: #339933;">:</span>
<a name="line247"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_STRING</span><span style="color: #339933;">;</span>
<a name="line248"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BINARY</span> <span style="color: #339933;">:</span>
<a name="line249"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_BINARY</span><span style="color: #339933;">;</span>
<a name="line250"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BOOLEAN</span> <span style="color: #339933;">:</span>
<a name="line251"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_BOOLEAN</span><span style="color: #339933;">;</span>
<a name="line252"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">LONG</span> <span style="color: #339933;">:</span>
<a name="line253"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_LONG</span><span style="color: #339933;">;</span>
<a name="line254"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DOUBLE</span> <span style="color: #339933;">:</span>
<a name="line255"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_DOUBLE</span><span style="color: #339933;">;</span>
<a name="line256"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DECIMAL</span> <span style="color: #339933;">:</span>
<a name="line257"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_DECIMAL</span><span style="color: #339933;">;</span>
<a name="line258"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><a href="http://www.php.net/date"><span style="color: #990000;">DATE</span></a> <span style="color: #339933;">:</span>
<a name="line259"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_DATE</span><span style="color: #339933;">;</span>
<a name="line260"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">NAME</span> <span style="color: #339933;">:</span>
<a name="line261"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_NAME</span><span style="color: #339933;">;</span>
<a name="line262"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">PATH</span> <span style="color: #339933;">:</span>
<a name="line263"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_PATH</span><span style="color: #339933;">;</span>
<a name="line264"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">REFERENCE</span> <span style="color: #339933;">:</span>
<a name="line265"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_REFERENCE</span><span style="color: #339933;">;</span>
<a name="line266"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">WEAKREFERENCE</span> <span style="color: #339933;">:</span>
<a name="line267"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_WEAKREFERENCE</span><span style="color: #339933;">;</span>
<a name="line268"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">URI</span> <span style="color: #339933;">:</span>
<a name="line269"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">TYPENAME_URI</span><span style="color: #339933;">;</span>
<a name="line270"></a>            <span style="color: #b1b100;">default</span><span style="color: #339933;">:</span>
<a name="line271"></a>                <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \InvalidArgumentException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Unknown type ('</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$type</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">') given.'</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1257170231</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line272"></a>        <span style="color: #009900;">&#125;</span>
<a name="line273"></a>    <span style="color: #009900;">&#125;</span>
<a name="line274"></a>&nbsp;
<a name="line275"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line276"></a>     * Returns the numeric constant value of the type with the specified name.
<a name="line277"></a>     *
<a name="line278"></a>     * @param string $name The name of the property type
<a name="line279"></a>     * @return int The numeric constant value
<a name="line280"></a>     *
<a name="line281"></a>     * @throws \InvalidArgumentException if the given name is unknown.
<a name="line282"></a>     * @api
<a name="line283"></a>     */</span>
<a name="line284"></a>    static <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> valueFromName<span style="color: #009900;">&#40;</span><span style="color: #000088;">$name</span><span style="color: #009900;">&#41;</span>
<a name="line285"></a>    <span style="color: #009900;">&#123;</span>
<a name="line286"></a>        <span style="color: #b1b100;">switch</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/strtolower"><span style="color: #990000;">strtolower</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$name</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line287"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'undefined'</span><span style="color: #339933;">:</span>
<a name="line288"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">UNDEFINED</span><span style="color: #339933;">;</span>
<a name="line289"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'string'</span><span style="color: #339933;">:</span>
<a name="line290"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">STRING</span><span style="color: #339933;">;</span>
<a name="line291"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'binary'</span><span style="color: #339933;">:</span>
<a name="line292"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BINARY</span><span style="color: #339933;">;</span>
<a name="line293"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'long'</span><span style="color: #339933;">:</span>
<a name="line294"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">LONG</span><span style="color: #339933;">;</span>
<a name="line295"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'double'</span><span style="color: #339933;">:</span>
<a name="line296"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DOUBLE</span><span style="color: #339933;">;</span>
<a name="line297"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'date'</span><span style="color: #339933;">:</span>
<a name="line298"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><a href="http://www.php.net/date"><span style="color: #990000;">DATE</span></a><span style="color: #339933;">;</span>
<a name="line299"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'boolean'</span><span style="color: #339933;">:</span>
<a name="line300"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BOOLEAN</span><span style="color: #339933;">;</span>
<a name="line301"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'name'</span><span style="color: #339933;">:</span>
<a name="line302"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">NAME</span><span style="color: #339933;">;</span>
<a name="line303"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'path'</span><span style="color: #339933;">:</span>
<a name="line304"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">PATH</span><span style="color: #339933;">;</span>
<a name="line305"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'reference'</span><span style="color: #339933;">:</span>
<a name="line306"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">REFERENCE</span><span style="color: #339933;">;</span>
<a name="line307"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'weakreference'</span><span style="color: #339933;">:</span>
<a name="line308"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">WEAKREFERENCE</span><span style="color: #339933;">;</span>
<a name="line309"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'uri'</span><span style="color: #339933;">:</span>
<a name="line310"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">URI</span><span style="color: #339933;">;</span>
<a name="line311"></a>            <span style="color: #b1b100;">case</span> <span style="color: #0000ff;">'decimal'</span><span style="color: #339933;">:</span>
<a name="line312"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DECIMAL</span><span style="color: #339933;">;</span>
<a name="line313"></a>            <span style="color: #b1b100;">default</span><span style="color: #339933;">:</span>
<a name="line314"></a>                <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \InvalidArgumentException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Unknown type name ('</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$name</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">') given.'</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1257170232</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line315"></a>        <span style="color: #009900;">&#125;</span>
<a name="line316"></a>    <span style="color: #009900;">&#125;</span>
<a name="line317"></a>&nbsp;
<a name="line318"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line319"></a>     * Determine PropertyType from on variable type.
<a name="line320"></a>     *
<a name="line321"></a>     * This is most of the remainder of ValueFactory that is still needed.
<a name="line322"></a>     *
<a name="line323"></a>     * - if the given $value is a Node object, type will be REFERENCE, unless
<a name="line324"></a>     *    $weak is set to true which results in WEAKREFERENCE
<a name="line325"></a>     * - if the given $value is a DateTime object, the type will be DATE.
<a name="line326"></a>     *
<a name="line327"></a>     * &amp;nbsp;
<a name="line328"></a>     *
<a name="line329"></a>     * @param mixed $value The variable we need to know the type of
<a name="line330"></a>     * @param boolean $weak When a Node is given as $value this can be given as true to create a WEAKREFERENCE.
<a name="line331"></a>     * @return One of the self constants
<a name="line332"></a>     * @api
<a name="line333"></a>     */</span>
<a name="line334"></a>    <span style="color: #000000; font-weight: bold;">public</span> static <span style="color: #000000; font-weight: bold;">function</span> determineType<span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #339933;">,</span> <span style="color: #000088;">$weak</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span>
<a name="line335"></a>    <span style="color: #009900;">&#123;</span>
<a name="line336"></a>        <span style="color: #666666; font-style: italic;">// name, path, reference, weak reference, uri are string, explicitly specify type if you need</span>
<a name="line337"></a>        <span style="color: #666666; font-style: italic;">// decimal is handled as string, explicitly specify type if you need</span>
<a name="line338"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_string"><span style="color: #990000;">is_string</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line339"></a>            <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/preg_match"><span style="color: #990000;">preg_match</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;/^(\d{4})-(\d{2})-(\d{2})T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])/&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$value</span><span style="color: #339933;">,</span> <span style="color: #000088;">$matches</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line340"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><a href="http://www.php.net/date"><span style="color: #990000;">DATE</span></a><span style="color: #339933;">;</span>
<a name="line341"></a>            <span style="color: #009900;">&#125;</span>
<a name="line342"></a>&nbsp;
<a name="line343"></a>            <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">STRING</span><span style="color: #339933;">;</span>
<a name="line344"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_resource"><span style="color: #990000;">is_resource</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line345"></a>            <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BINARY</span><span style="color: #339933;">;</span>
<a name="line346"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_int"><span style="color: #990000;">is_int</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line347"></a>            <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">LONG</span><span style="color: #339933;">;</span>
<a name="line348"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_float"><span style="color: #990000;">is_float</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line349"></a>            <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DOUBLE</span><span style="color: #339933;">;</span>
<a name="line350"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_bool"><span style="color: #990000;">is_bool</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line351"></a>            <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BOOLEAN</span><span style="color: #339933;">;</span>
<a name="line352"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_object"><span style="color: #990000;">is_object</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line353"></a>            <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span> instanceof \DateTime<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line354"></a>                <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><a href="http://www.php.net/date"><span style="color: #990000;">DATE</span></a><span style="color: #339933;">;</span>
<a name="line355"></a>            <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span> instanceof \PHPCR\NodeInterface<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line356"></a>                <span style="color: #b1b100;">return</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$weak</span><span style="color: #009900;">&#41;</span> ?
<a name="line357"></a>                        <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">WEAKREFERENCE</span> <span style="color: #339933;">:</span>
<a name="line358"></a>                        <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">REFERENCE</span><span style="color: #339933;">;</span>
<a name="line359"></a>            <span style="color: #009900;">&#125;</span>
<a name="line360"></a>        <span style="color: #009900;">&#125;</span>
<a name="line361"></a>&nbsp;
<a name="line362"></a>        <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \PHPCR\ValueFormatException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Can not determine type of property with value &quot;'</span><span style="color: #339933;">.</span><a href="http://www.php.net/var_export"><span style="color: #990000;">var_export</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$value</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span><span style="color: #0000ff;">'&quot;'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line363"></a>    <span style="color: #009900;">&#125;</span>
<a name="line364"></a>&nbsp;
<a name="line365"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line366"></a>     * Attempt to convert $values into the proper format for $type.
<a name="line367"></a>     *
<a name="line368"></a>     * This is the other remaining part of ValueFactory functionality that is
<a name="line369"></a>     * still needed.
<a name="line370"></a>     *
<a name="line371"></a>     * Note that for converting to boolean, we follow the PHP convention of
<a name="line372"></a>     * treating any non-empty string as true, not just the word &quot;true&quot;.
<a name="line373"></a>     *
<a name="line374"></a>     * @param mixed $values The value or value array to check and convert
<a name="line375"></a>     * @param int $type Target type to convert into. One of the type constants in \PHPCR\PropertyType
<a name="line376"></a>     * @return the value typecasted into the proper format (throws an exception if conversion is not possible)
<a name="line377"></a>     *
<a name="line378"></a>     * @throws \PHPCR\ValueFormatException is thrown if the specified value cannot be converted to the specified type.
<a name="line379"></a>     * @throws \PHPCR\RepositoryException if the specified Node is not referenceable, the current Session is no longer active, or another error occurs.
<a name="line380"></a>     * @throws \InvalidArgumentException if the specified DateTime value cannot be expressed in the ISO 8601-based format defined in the JCR 2.0 specification and the implementation does not support dates incompatible with that format.
<a name="line381"></a>     */</span>
<a name="line382"></a>    <span style="color: #000000; font-weight: bold;">public</span> static <span style="color: #000000; font-weight: bold;">function</span> convertType<span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span><span style="color: #339933;">,</span> <span style="color: #000088;">$type</span><span style="color: #009900;">&#41;</span>
<a name="line383"></a>    <span style="color: #009900;">&#123;</span>
<a name="line384"></a>        <span style="color: #000088;">$ret</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">;</span>
<a name="line385"></a>        <span style="color: #000088;">$isArray</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line386"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><span style="color: #000088;">$isArray</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line387"></a>            <span style="color: #000088;">$values</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line388"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span>
<a name="line389"></a>            <span style="color: #000088;">$ret</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line390"></a>        <span style="color: #009900;">&#125;</span>
<a name="line391"></a>        <span style="color: #b1b100;">switch</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$type</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line392"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">STRING</span><span style="color: #339933;">:</span>
<a name="line393"></a>                <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line394"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span> instanceof \DateTime<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line395"></a>                        <span style="color: #666666; font-style: italic;">// Milliseconds formating is not possible in PHP so we</span>
<a name="line396"></a>                        <span style="color: #666666; font-style: italic;">// construct it by cutting microseconds to 3 positions.</span>
<a name="line397"></a>                        <span style="color: #666666; font-style: italic;">// This might not be as accurate as &quot;real&quot; rounded milliseconds.</span>
<a name="line398"></a>                        <span style="color: #000088;">$tmp</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">format</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Y-m-d\TH:i:s.'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line399"></a>                        <span style="color: #000088;">$tmp</span> <span style="color: #339933;">.=</span> <a href="http://www.php.net/substr"><span style="color: #990000;">substr</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">format</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'u'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line400"></a>                        <span style="color: #000088;">$tmp</span> <span style="color: #339933;">.=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">format</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'P'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line401"></a>                        <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$tmp</span><span style="color: #339933;">;</span>
<a name="line402"></a>                    <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_resource"><span style="color: #990000;">is_resource</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line403"></a>                        <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/stream_get_contents"><span style="color: #990000;">stream_get_contents</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line404"></a>                        <a href="http://www.php.net/rewind"><span style="color: #990000;">rewind</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line405"></a>                    <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span>
<a name="line406"></a>                        <a href="http://www.php.net/settype"><span style="color: #990000;">settype</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'string'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line407"></a>                        <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">;</span>
<a name="line408"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line409"></a>                <span style="color: #009900;">&#125;</span>
<a name="line410"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line411"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DECIMAL</span><span style="color: #339933;">:</span>
<a name="line412"></a>                <span style="color: #000088;">$typename</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'string'</span><span style="color: #339933;">;</span>
<a name="line413"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line414"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">LONG</span><span style="color: #339933;">:</span>
<a name="line415"></a>                <span style="color: #000088;">$typename</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'integer'</span><span style="color: #339933;">;</span>
<a name="line416"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line417"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">DOUBLE</span><span style="color: #339933;">:</span>
<a name="line418"></a>                <span style="color: #000088;">$typename</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'double'</span><span style="color: #339933;">;</span>
<a name="line419"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line420"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BOOLEAN</span><span style="color: #339933;">:</span>
<a name="line421"></a>                <span style="color: #000088;">$typename</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'boolean'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//we follow php logic and are not binary compatible with jackrabbit. jcr is not specific about details of the conversion.</span>
<a name="line422"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line423"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><a href="http://www.php.net/date"><span style="color: #990000;">DATE</span></a><span style="color: #339933;">:</span>
<a name="line424"></a>                <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line425"></a>                    <span style="color: #000088;">$datetime</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #339933;">;</span>
<a name="line426"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span> instanceof \DateTime<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line427"></a>                        <span style="color: #000088;">$datetime</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">;</span>
<a name="line428"></a>                    <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_int"><span style="color: #990000;">is_int</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line429"></a>                        <span style="color: #000088;">$datetime</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> \DateTime<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line430"></a>                        <span style="color: #000088;">$datetime</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$datetime</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">setTimestamp</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line431"></a>                    <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_string"><span style="color: #990000;">is_string</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line432"></a>                        try <span style="color: #009900;">&#123;</span>
<a name="line433"></a>                            <span style="color: #000088;">$datetime</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> \DateTime<span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line434"></a>                        <span style="color: #009900;">&#125;</span> catch <span style="color: #009900;">&#40;</span>\Exception <span style="color: #000088;">$e</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line435"></a>                            <span style="color: #000088;">$datetime</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #339933;">;</span>
<a name="line436"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line437"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line438"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$datetime</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line439"></a>                        <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \PHPCR\ValueFormatException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Can not convert &quot;'</span><span style="color: #339933;">.</span><a href="http://www.php.net/var_export"><span style="color: #990000;">var_export</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span><span style="color: #0000ff;">'&quot; into a date'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line440"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line441"></a>                    <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$datetime</span><span style="color: #339933;">;</span>
<a name="line442"></a>                <span style="color: #009900;">&#125;</span>
<a name="line443"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line444"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">REFERENCE</span><span style="color: #339933;">:</span>
<a name="line445"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">WEAKREFERENCE</span><span style="color: #339933;">:</span>
<a name="line446"></a>                <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line447"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span> instanceof \PHPCR\NodeInterface<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line448"></a>                        <span style="color: #666666; font-style: italic;">// In Jackrabbit a new node cannot be referenced until it has been persisted</span>
<a name="line449"></a>                        <span style="color: #666666; font-style: italic;">// See: https://issues.apache.org/jira/browse/JCR-1614</span>
<a name="line450"></a>                        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">isNew</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">||</span> <span style="color: #339933;">!</span> <span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">isNodeType</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mix:referenceable'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line451"></a>                            <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \PHPCR\ValueFormatException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Node '</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPath</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">' is not referencable'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line452"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line453"></a>                        <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getIdentifier</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line454"></a>                    <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">elseif</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_string"><span style="color: #990000;">is_string</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <span style="color: #339933;">!</span> <a href="http://www.php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line455"></a>                        <span style="color: #666666; font-style: italic;">//could check if string is valid uuid, but backend will do that</span>
<a name="line456"></a>                        <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">;</span>
<a name="line457"></a>                    <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span>
<a name="line458"></a>                        <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \PHPCR\ValueFormatException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$v</span> is not a unique id&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line459"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line460"></a>                <span style="color: #009900;">&#125;</span>
<a name="line461"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line462"></a>            <span style="color: #b1b100;">case</span> <span style="color: #000000; font-weight: bold;">self</span><span style="color: #339933;">::</span><span style="color: #004000;">BINARY</span><span style="color: #339933;">:</span>
<a name="line463"></a>                <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line464"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/is_string"><span style="color: #990000;">is_string</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line465"></a>                        <span style="color: #000088;">$f</span> <span style="color: #339933;">=</span> <a href="http://www.php.net/fopen"><span style="color: #990000;">fopen</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'php://memory'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'rwb+'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line466"></a>                        <a href="http://www.php.net/fwrite"><span style="color: #990000;">fwrite</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$f</span><span style="color: #339933;">,</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line467"></a>                        <a href="http://www.php.net/rewind"><span style="color: #990000;">rewind</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$f</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line468"></a>                        <span style="color: #000088;">$v</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$f</span><span style="color: #339933;">;</span>
<a name="line469"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line470"></a>&nbsp;
<a name="line471"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://www.php.net/is_resource"><span style="color: #990000;">is_resource</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line472"></a>                        <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \PHPCR\ValueFormatException<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Cannot convert value into a binary resource'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line473"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line474"></a>&nbsp;
<a name="line475"></a>                    <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">;</span>
<a name="line476"></a>                <span style="color: #009900;">&#125;</span>
<a name="line477"></a>            <span style="color: #666666; font-style: italic;">//FIXME: type PATH is missing. should automatically read property and node with getPath.</span>
<a name="line478"></a>            <span style="color: #b1b100;">default</span><span style="color: #339933;">:</span>
<a name="line479"></a>                <span style="color: #666666; font-style: italic;">//FIXME: handle other types somehow</span>
<a name="line480"></a>                <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line481"></a>                    <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">;</span>
<a name="line482"></a>                <span style="color: #009900;">&#125;</span>
<a name="line483"></a>                <span style="color: #b1b100;">break</span><span style="color: #339933;">;</span>
<a name="line484"></a>            <span style="color: #666666; font-style: italic;">//TODO: more type checks or casts? name, path, uri, decimal. but the backend can handle the checks.</span>
<a name="line485"></a>        <span style="color: #009900;">&#125;</span>
<a name="line486"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://www.php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$typename</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line487"></a>            <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$values</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$v</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line488"></a>                <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span> <a href="http://www.php.net/settype"><span style="color: #990000;">settype</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$v</span><span style="color: #339933;">,</span> <span style="color: #000088;">$typename</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//TODO: will this work for streams? or should we read them into string and then convert?</span>
<a name="line489"></a>                    <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> \PHPCR\ValueFormatException<span style="color: #339933;">;</span>
<a name="line490"></a>                <span style="color: #009900;">&#125;</span>
<a name="line491"></a>                <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$v</span><span style="color: #339933;">;</span>
<a name="line492"></a>            <span style="color: #009900;">&#125;</span>
<a name="line493"></a>        <span style="color: #009900;">&#125;</span>
<a name="line494"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><span style="color: #000088;">$isArray</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line495"></a>            <span style="color: #000088;">$ret</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$ret</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
<a name="line496"></a>        <span style="color: #009900;">&#125;</span>
<a name="line497"></a>        <span style="color: #b1b100;">return</span> <span style="color: #000088;">$ret</span><span style="color: #339933;">;</span>
<a name="line498"></a>    <span style="color: #009900;">&#125;</span>
<a name="line499"></a><span style="color: #009900;">&#125;</span>
<a name="line500"></a>&nbsp;</pre>
<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../../overview-files.html">Files</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../todo-list.html">Todo</a></li>
<li><a href="../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../index.html" target="_top">Frames</a>
<a href="../../source/phpcr/propertytype.php.html" target="_top">No frames</a>
</div>
<hr>

<p id="footer">This document was generated by <a href="http://peej.github.com/phpdoctor/">PHPDoctor: The PHP Documentation Creator</a></p>

</body>

</html>