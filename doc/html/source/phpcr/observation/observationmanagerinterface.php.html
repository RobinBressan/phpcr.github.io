<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="PHPDoctor 2RC4 (http://peej.github.com/phpdoctor/)">
<meta name="when" content="Mon, 30 May 2011 13:13:30 +0000">

<link rel="stylesheet" type="text/css" href="../../../stylesheet.css">
<link rel="start" href="../../../overview-summary.html">

<title>PHPCR/Observation/ObservationManagerInterface.php (PHPCR API)</title>

</head>
<body id="file" onload="parent.document.title=document.title;">

<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../../../overview-files.html">Files</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../todo-list.html">Todo</a></li>
<li><a href="../../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../../index.html" target="_top">Frames</a>
<a href="../../../source/phpcr/observation/observationmanagerinterface.php.html" target="_top">No frames</a>
</div>
<hr>

<h1>PHPCR/Observation/ObservationManagerInterface.php</h1>
<div class="comment" id="overview_description"><p>This file is part of the PHPCR API and was originally ported from the Java
JCR API to PHP by Karsten Dambekalns for the FLOW3 project.</p><p>Copyright 2008-2011 Karsten Dambekalns <karsten@typo3.org></p><p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p><p>http://www.apache.org/licenses/LICENSE-2.0</p><p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p></div>

<hr>

<a name="line1"></a><pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
<a name="line2"></a>&nbsp;
<a name="line3"></a><span style="color: #009933; font-style: italic;">/**
<a name="line4"></a> * This file is part of the PHPCR API and was originally ported from the Java
<a name="line5"></a> * JCR API to PHP by Karsten Dambekalns for the FLOW3 project.
<a name="line6"></a> *
<a name="line7"></a> * Copyright 2008-2011 Karsten Dambekalns &lt;karsten@typo3.org&gt;
<a name="line8"></a> *
<a name="line9"></a> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<a name="line10"></a> * you may not use this file except in compliance with the License.
<a name="line11"></a> * You may obtain a copy of the License at
<a name="line12"></a> *
<a name="line13"></a> *     http://www.apache.org/licenses/LICENSE-2.0
<a name="line14"></a> *
<a name="line15"></a> * Unless required by applicable law or agreed to in writing, software
<a name="line16"></a> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<a name="line17"></a> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<a name="line18"></a> * See the License for the specific language governing permissions and
<a name="line19"></a> * limitations under the License.
<a name="line20"></a> *
<a name="line21"></a> * @license http://www.apache.org/licenses/LICENSE-2.0 Apache Software License 2.0
<a name="line22"></a> * @link http://phpcr.github.com/
<a name="line23"></a>*/</span>
<a name="line24"></a>&nbsp;
<a name="line25"></a><span style="color: #000000; font-weight: bold;">namespace</span> PHPCR\Observation<span style="color: #339933;">;</span>
<a name="line26"></a>&nbsp;
<a name="line27"></a><span style="color: #009933; font-style: italic;">/**
<a name="line28"></a> * The ObservationManager object.
<a name="line29"></a> *
<a name="line30"></a> * Acquired via Workspace.getObservationManager(). Allows for the registration
<a name="line31"></a> * and deregistration of event listeners.
<a name="line32"></a> *
<a name="line33"></a> * The \Traversable interface enables the implementation to be addressed with
<a name="line34"></a> * &lt;b&gt;foreach&lt;/b&gt;. ObservationManager has to implement either \RecursiveIterator
<a name="line35"></a> * or \Iterator.
<a name="line36"></a> * The iterator is equivalent to &lt;b&gt;getRegisteredEventListeners()&lt;/b&gt; returning
<a name="line37"></a> * a list of all registered event listeners. The iterator keys have no
<a name="line38"></a> * significant meaning.
<a name="line39"></a> *
<a name="line40"></a> * @package phpcr
<a name="line41"></a> * @subpackage interfaces
<a name="line42"></a> * @api
<a name="line43"></a> */</span>
<a name="line44"></a><span style="color: #000000; font-weight: bold;">interface</span> ObservationManagerInterface <span style="color: #000000; font-weight: bold;">extends</span> \Traversable
<a name="line45"></a><span style="color: #009900;">&#123;</span>
<a name="line46"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line47"></a>     * Adds an event listener that listens for the specified eventTypes (a
<a name="line48"></a>     * combination of one or more event types encoded as a bit mask value).
<a name="line49"></a>     * The set of events will be further filtered by the access rights of the c
<a name="line50"></a>     * urrent Session as well as the restrictions specified by the parameters of
<a name="line51"></a>     * this method. These restrictions are stated in terms of characteristics of the
<a name="line52"></a>     * associated parent node of the event.
<a name="line53"></a>     *
<a name="line54"></a>     * The associated parent node of an event is the parent node of the item at (or
<a name="line55"></a>     * formerly at) the path returned by Event.getPath(). The following restrictions
<a name="line56"></a>     * are available:
<a name="line57"></a>     *  &lt;b&gt;absPath&lt;/b&gt;, &lt;b&gt;isDeep&lt;/b&gt;: Only events whose associated parent node is at absPath (or
<a name="line58"></a>     *   within its subgraph, if isDeep is true) will be received. It is permissible
<a name="line59"></a>     *   to register a listener for a path where no node currently exists.
<a name="line60"></a>     *  &lt;b&gt;uuid&lt;/b&gt;: Only events whose associated parent node has one of the identifiers in
<a name="line61"></a>     *   this list will be received. If his parameter is null then no identifier-
<a name="line62"></a>     *   related restriction is placed on events received. Note that specifying an
<a name="line63"></a>     *   empty array instead of null would result in no nodes being listened to. The
<a name="line64"></a>     *   term &quot;UUID&quot; is used for compatibility with JCR 1.0.
<a name="line65"></a>     *  &lt;b&gt;nodeTypeName&lt;/b&gt;: Only events whose associated parent node has one of the node
<a name="line66"></a>     *   types (or a subtype of one of the node types) in this list will be received.
<a name="line67"></a>     *   If his parameter is null then no node type-related restriction is placed on
<a name="line68"></a>     *   events received. Note that specifying an empty array instead of null would
<a name="line69"></a>     *   result in no nodes types being listened to.
<a name="line70"></a>     *
<a name="line71"></a>     * The restrictions are &quot;ANDed&quot; together. In other words, for a particular node
<a name="line72"></a>     * to be &quot;listened to&quot; it must meet all the restrictions.
<a name="line73"></a>     * Additionally, if noLocal is true, then events generated by the session
<a name="line74"></a>     * through which the listener was registered are ignored. Otherwise, they are
<a name="line75"></a>     * not ignored.
<a name="line76"></a>     *
<a name="line77"></a>     * The filters of an already-registered EventListener can be changed at runtime
<a name="line78"></a>     * by re-registering the same EventListener object (i.e. the same actual object)
<a name="line79"></a>     * with a new set of filter arguments. The implementation must ensure that no
<a name="line80"></a>     * events are lost during the changeover.
<a name="line81"></a>     *
<a name="line82"></a>     * In addition to the filters placed on a listener above, the scope of
<a name="line83"></a>     * observation support, in terms of which subgraphs are observable, may also be
<a name="line84"></a>     * subject to implementation-specific restrictions. For example, in some
<a name="line85"></a>     * repositories observation of changes in the jcr:system subgraph may not be
<a name="line86"></a>     * supported
<a name="line87"></a>     *
<a name="line88"></a>     * @param \PHPCR\Observation\EventListenerInterface $listener An EventListener object.
<a name="line89"></a>     * @param integer $eventTypes A combination of one or more event type constants encoded as a bitmask.
<a name="line90"></a>     * @param string $absPath The absolute path identifying the node to be observed.
<a name="line91"></a>     * @param boolean $isDeep Switch to define the given path as a reference to a child node.
<a name="line92"></a>     * @param array $uuid List of identifiers of events to be recieved.
<a name="line93"></a>     * @param array $nodeTypeName List of node type names to identify the events to be recieved.
<a name="line94"></a>     * @param boolean $noLocal switch to handle local events.
<a name="line95"></a>     * @return void
<a name="line96"></a>     *
<a name="line97"></a>     * @throws \PHPCR\RepositoryException if an error occurs.
<a name="line98"></a>     * @api
<a name="line99"></a>     */</span>
<a name="line100"></a>    <span style="color: #000000; font-weight: bold;">function</span> addEventListener<span style="color: #009900;">&#40;</span>\PHPCR\Observation\EventListenerInterface <span style="color: #000088;">$listener</span><span style="color: #339933;">,</span> <span style="color: #000088;">$eventTypes</span><span style="color: #339933;">,</span> <span style="color: #000088;">$absPath</span><span style="color: #339933;">,</span>
<a name="line101"></a>                                     <span style="color: #000088;">$isDeep</span><span style="color: #339933;">,</span> <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a> <span style="color: #000088;">$uuid</span><span style="color: #339933;">,</span> <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a> <span style="color: #000088;">$nodeTypeName</span><span style="color: #339933;">,</span> <span style="color: #000088;">$noLocal</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line102"></a>&nbsp;
<a name="line103"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line104"></a>     * Deregisters an event listener.
<a name="line105"></a>     *
<a name="line106"></a>     * A listener may be deregistered while it is being executed. The deregistration
<a name="line107"></a>     * method will block until the listener has completed executing. An exception to
<a name="line108"></a>     * this rule is a listener which deregisters itself from within the onEvent
<a name="line109"></a>     * method. In this case, the deregistration method returns immediately, but
<a name="line110"></a>     * deregistration will effectively be delayed until the listener completes.
<a name="line111"></a>     *
<a name="line112"></a>     * @param \PHPCR\Observation\EventListenerInterface $listener The listener to deregister.
<a name="line113"></a>     * @return void
<a name="line114"></a>     *
<a name="line115"></a>     * @throws \PHPCR\RepositoryException if an error occurs.
<a name="line116"></a>     * @api
<a name="line117"></a>     */</span>
<a name="line118"></a>    <span style="color: #000000; font-weight: bold;">function</span> removeEventListener<span style="color: #009900;">&#40;</span>\PHPCR\Observation\EventListenerInterface <span style="color: #000088;">$listener</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line119"></a>&nbsp;
<a name="line120"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line121"></a>     * Returns all event listeners that have been registered through this session.
<a name="line122"></a>     *
<a name="line123"></a>     * If no listeners have been registered, an empty iterator is returned.
<a name="line124"></a>     *
<a name="line125"></a>     * @return Iterator implementing &lt;b&gt;SeekableIterator&lt;/b&gt; and &lt;b&gt;Countable&lt;/b&gt;.
<a name="line126"></a>     *                  Values are the EventListenerInterface instances. Keys have no meaning.
<a name="line127"></a>     *
<a name="line128"></a>     * @throws \PHPCR\RepositoryException if an error occurs
<a name="line129"></a>     * @api
<a name="line130"></a>     */</span>
<a name="line131"></a>    <span style="color: #000000; font-weight: bold;">function</span> getRegisteredEventListeners<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line132"></a>&nbsp;
<a name="line133"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line134"></a>     * Sets the user data information that will be returned by Event.getUserData().
<a name="line135"></a>     *
<a name="line136"></a>     * @param string $userData the user data
<a name="line137"></a>     * @return void
<a name="line138"></a>     *
<a name="line139"></a>     * @throws \PHPCR\RepositoryException if an error occurs
<a name="line140"></a>     * @api
<a name="line141"></a>     */</span>
<a name="line142"></a>    <span style="color: #000000; font-weight: bold;">function</span> setUserData<span style="color: #009900;">&#40;</span><span style="color: #000088;">$userData</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line143"></a>&nbsp;
<a name="line144"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line145"></a>     * Retrieves the event journal for this workspace.
<a name="line146"></a>     *
<a name="line147"></a>     * If journaled observation is not supported for this workspace, null is
<a name="line148"></a>     * returned.
<a name="line149"></a>     *
<a name="line150"></a>     * Events returned in the EventJournal instance will be filtered according
<a name="line151"></a>     * to the parameters of this method, the current session's access
<a name="line152"></a>     * restrictions as well as any additional restrictions specified through
<a name="line153"></a>     * implemention-specific configuration.
<a name="line154"></a>     *
<a name="line155"></a>     * The parameters of this method filter the event set in the same way as
<a name="line156"></a>     * they do in addEventListener().
<a name="line157"></a>     *
<a name="line158"></a>     * @param integer $eventTypes A combination of one or more event type constants encoded as a bitmask.
<a name="line159"></a>     * @param string $absPath an absolute path.
<a name="line160"></a>     * @param boolean $isDeep Switch to define the given path as a reference to a child node.
<a name="line161"></a>     * @param array $uuid array of identifiers.
<a name="line162"></a>     * @param array $nodeTypeName array of node type names.
<a name="line163"></a>     * @return \PHPCR\Observation\EventJournalInterface an EventJournal (or null).
<a name="line164"></a>     *
<a name="line165"></a>     * @throws \PHPCR\RepositoryException if an error occurs
<a name="line166"></a>     * @api
<a name="line167"></a>     */</span>
<a name="line168"></a>    <span style="color: #000000; font-weight: bold;">function</span> getEventJournal<span style="color: #009900;">&#40;</span><span style="color: #000088;">$eventTypes</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$absPath</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000088;">$isDeep</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a> <span style="color: #000088;">$uuid</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span>
<a name="line169"></a>                                    <a href="http://www.php.net/array"><span style="color: #990000;">array</span></a> <span style="color: #000088;">$nodeTypeName</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line170"></a><span style="color: #009900;">&#125;</span>
<a name="line171"></a>&nbsp;</pre>
<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../../../overview-files.html">Files</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../todo-list.html">Todo</a></li>
<li><a href="../../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../../index.html" target="_top">Frames</a>
<a href="../../../source/phpcr/observation/observationmanagerinterface.php.html" target="_top">No frames</a>
</div>
<hr>

<p id="footer">This document was generated by <a href="http://peej.github.com/phpdoctor/">PHPDoctor: The PHP Documentation Creator</a></p>

</body>

</html>