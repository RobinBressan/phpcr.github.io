<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="PHPDoctor 2RC4 (http://peej.github.com/phpdoctor/)">
<meta name="when" content="Tue, 26 Jul 2011 15:56:52 +0000">

<link rel="stylesheet" type="text/css" href="../../../stylesheet.css">
<link rel="start" href="../../../overview-summary.html">

<title>PHPCR/Util/TraversingItemVisitor.php (PHPCR API)</title>

</head>
<body id="file" onload="parent.document.title=document.title;">

<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../../../overview-files.html">Files</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../todo-list.html">Todo</a></li>
<li><a href="../../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../../index.html" target="_top">Frames</a>
<a href="../../../source/phpcr/util/traversingitemvisitor.php.html" target="_top">No frames</a>
</div>
<hr>

<h1>PHPCR/Util/TraversingItemVisitor.php</h1>
<div class="comment" id="overview_description"><p>This file is part of the PHPCR API and was originally ported from the Java
JCR API to PHP by Karsten Dambekalns for the FLOW3 project.</p><p>Copyright 2008-2011 Karsten Dambekalns <karsten@typo3.org></p><p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p><p>http://www.apache.org/licenses/LICENSE-2.0</p><p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p></div>

<hr>

<a name="line1"></a><pre class="php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;?php</span>
<a name="line2"></a>&nbsp;
<a name="line3"></a><span style="color: #009933; font-style: italic;">/**
<a name="line4"></a> * This file is part of the PHPCR API and was originally ported from the Java
<a name="line5"></a> * JCR API to PHP by Karsten Dambekalns for the FLOW3 project.
<a name="line6"></a> *
<a name="line7"></a> * Copyright 2008-2011 Karsten Dambekalns &lt;karsten@typo3.org&gt;
<a name="line8"></a> *
<a name="line9"></a> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<a name="line10"></a> * you may not use this file except in compliance with the License.
<a name="line11"></a> * You may obtain a copy of the License at
<a name="line12"></a> *
<a name="line13"></a> *     http://www.apache.org/licenses/LICENSE-2.0
<a name="line14"></a> *
<a name="line15"></a> * Unless required by applicable law or agreed to in writing, software
<a name="line16"></a> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<a name="line17"></a> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<a name="line18"></a> * See the License for the specific language governing permissions and
<a name="line19"></a> * limitations under the License.
<a name="line20"></a> *
<a name="line21"></a> * @license http://www.apache.org/licenses/LICENSE-2.0 Apache Software License 2.0
<a name="line22"></a> * @link http://phpcr.github.com/
<a name="line23"></a>*/</span>
<a name="line24"></a>&nbsp;
<a name="line25"></a><span style="color: #000000; font-weight: bold;">namespace</span> PHPCR\Util<span style="color: #339933;">;</span>
<a name="line26"></a>&nbsp;
<a name="line27"></a><span style="color: #009933; font-style: italic;">/**
<a name="line28"></a> * An implementation of ItemVisitor.
<a name="line29"></a> *
<a name="line30"></a> * TraversingItemVisitor is an abstract utility class which allows to easily
<a name="line31"></a> * traverse an Item hierarchy.
<a name="line32"></a> * You overwrite entering and leaving methods that get called for all
<a name="line33"></a> * properties encountered
<a name="line34"></a> *
<a name="line35"></a> * TraversingItemVisitor makes use of the Visitor Pattern as described in the
<a name="line36"></a> * book 'Design Patterns' by the Gang Of Four (Gamma et al.).
<a name="line37"></a> * Tree traversal is done observing the left-to-right order of child Items if
<a name="line38"></a> * such an order is supported and exists.
<a name="line39"></a> *
<a name="line40"></a> * @author Karsten Dambekalns &lt;karsten@typo3.org&gt;
<a name="line41"></a> * @author Day Management AG, Switzerland
<a name="line42"></a> * @package phpcr
<a name="line43"></a> * @subpackage interfaces
<a name="line44"></a> * @api
<a name="line45"></a> */</span>
<a name="line46"></a>abstract <span style="color: #000000; font-weight: bold;">class</span> TraversingItemVisitor implements \PHPCR\ItemVisitorInterface
<a name="line47"></a><span style="color: #009900;">&#123;</span>
<a name="line48"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line49"></a>     * Indicates if traversal should be done in a breadth-first manner rather
<a name="line50"></a>     * than depth-first (which is the default).
<a name="line51"></a>     * @var boolean
<a name="line52"></a>     */</span>
<a name="line53"></a>    <span style="color: #000000; font-weight: bold;">protected</span> <span style="color: #000088;">$breadthFirst</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #339933;">;</span>
<a name="line54"></a>&nbsp;
<a name="line55"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line56"></a>     * The 0-based depth up to which the hierarchy should be traversed (if it's
<a name="line57"></a>     * -1, the hierarchy will be traversed until there are no more children of
<a name="line58"></a>     * the current item).
<a name="line59"></a>     * @var integer
<a name="line60"></a>     */</span>
<a name="line61"></a>    <span style="color: #000000; font-weight: bold;">protected</span> <span style="color: #000088;">$maxDepth</span> <span style="color: #339933;">=</span> <span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span>
<a name="line62"></a>&nbsp;
<a name="line63"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line64"></a>     * Queue used to implement breadth-first traversal.
<a name="line65"></a>     * @var \SplQueue
<a name="line66"></a>     */</span>
<a name="line67"></a>    <span style="color: #000000; font-weight: bold;">protected</span> <span style="color: #000088;">$currentQueue</span><span style="color: #339933;">;</span>
<a name="line68"></a>&nbsp;
<a name="line69"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line70"></a>     * Queue used to implement breadth-first traversal.
<a name="line71"></a>     * @var \SplQueue
<a name="line72"></a>     */</span>
<a name="line73"></a>    <span style="color: #000000; font-weight: bold;">protected</span> <span style="color: #000088;">$nextQueue</span><span style="color: #339933;">;</span>
<a name="line74"></a>&nbsp;
<a name="line75"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line76"></a>     * Used to track hierarchy depth of item currently being processed.
<a name="line77"></a>     * @var integer
<a name="line78"></a>     */</span>
<a name="line79"></a>    <span style="color: #000000; font-weight: bold;">protected</span> <span style="color: #000088;">$currentDepth</span><span style="color: #339933;">;</span>
<a name="line80"></a>&nbsp;
<a name="line81"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line82"></a>     * Constructs a new instance of this class.
<a name="line83"></a>     *
<a name="line84"></a>     * @param boolean $breadthFirst if $breadthFirst is true then traversal is done in a breadth-first manner;
<a name="line85"></a>     *                              otherwise it is done in a depth-first manner (which is the default behavior).
<a name="line86"></a>     * @param integer $maxDepth the 0-based depth up to which the hierarchy should be traversed
<a name="line87"></a>     *                          (if it's -1, the hierarchy will be traversed until there are no more children
<a name="line88"></a>     *                          of the current item).
<a name="line89"></a>     *
<a name="line90"></a>     * @api
<a name="line91"></a>     */</span>
<a name="line92"></a>    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> TraversingItemVisitor<span style="color: #009900;">&#40;</span><span style="color: #000088;">$breadthFirst</span> <span style="color: #339933;">=</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #339933;">,</span> <span style="color: #000088;">$maxLevel</span> <span style="color: #339933;">=</span> <span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a name="line93"></a>    <span style="color: #009900;">&#123;</span>
<a name="line94"></a>        <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">breadthFirst</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$breadthFirst</span><span style="color: #339933;">;</span>
<a name="line95"></a>        <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">maxDepth</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$maxDepth</span><span style="color: #339933;">;</span>
<a name="line96"></a>&nbsp;
<a name="line97"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">breadthFirst</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line98"></a>            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentQueue</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> \SplQueue<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line99"></a>            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">nextQueue</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> \SplQueue<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line100"></a>        <span style="color: #009900;">&#125;</span>
<a name="line101"></a>        <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
<a name="line102"></a>    <span style="color: #009900;">&#125;</span>
<a name="line103"></a>&nbsp;
<a name="line104"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line105"></a>     * Implement this method to add behavior performed before a Property is visited.
<a name="line106"></a>     *
<a name="line107"></a>     * @param \PHPCR\ItemInterface $item the Item that is accepting this visitor.
<a name="line108"></a>     * @param integer $depth hierarchy level of this node (the root node starts at depth 0).
<a name="line109"></a>     * @return void
<a name="line110"></a>     *
<a name="line111"></a>     * @throws \PHPCR\RepositoryException if an error occurs.
<a name="line112"></a>     * @api
<a name="line113"></a>     */</span>
<a name="line114"></a>    <span style="color: #000000; font-weight: bold;">protected</span> abstract <span style="color: #000000; font-weight: bold;">function</span> entering<span style="color: #009900;">&#40;</span>\PHPCR\ItemInterface <span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$depth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line115"></a>&nbsp;
<a name="line116"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line117"></a>     * Implement this method to add behavior performed after a Property is visited.
<a name="line118"></a>     *
<a name="line119"></a>     * @param \PHPCR\ItemInterface $item the Item that is accepting this visitor.
<a name="line120"></a>     * @param integer $depth hierarchy level of this property (the root node starts at depth 0).
<a name="line121"></a>     * @return void
<a name="line122"></a>     *
<a name="line123"></a>     * @throws \PHPCR\RepositoryException if an error occurs.
<a name="line124"></a>     * @api
<a name="line125"></a>     */</span>
<a name="line126"></a>    <span style="color: #000000; font-weight: bold;">protected</span> abstract <span style="color: #000000; font-weight: bold;">function</span> leaving<span style="color: #009900;">&#40;</span>\PHPCR\ItemInterface <span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$depth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line127"></a>&nbsp;
<a name="line128"></a>    <span style="color: #009933; font-style: italic;">/**
<a name="line129"></a>     * Called when the Visitor is passed to an Item.
<a name="line130"></a>     *
<a name="line131"></a>     * It calls TraversingItemVisitor::entering() followed by
<a name="line132"></a>     * TraversingItemVisitor::leaving(). Implement these
<a name="line133"></a>     * abstract methods to specify behavior on 'arrival at' and 'after leaving'
<a name="line134"></a>     * the $item.
<a name="line135"></a>     *
<a name="line136"></a>     * If this method throws, the visiting process is aborted.
<a name="line137"></a>     *
<a name="line138"></a>     * @param \PHPCR\ItemInterface $item the Node or Property that is accepting this visitor.
<a name="line139"></a>     * @return void
<a name="line140"></a>     *
<a name="line141"></a>     * @throws \PHPCR\RepositoryException if an error occurs.
<a name="line142"></a>     * @api
<a name="line143"></a>     */</span>
<a name="line144"></a>    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> visit<span style="color: #009900;">&#40;</span>\PHPCR\ItemInterface <span style="color: #000088;">$item</span><span style="color: #009900;">&#41;</span>
<a name="line145"></a>    <span style="color: #009900;">&#123;</span>
<a name="line146"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line147"></a>            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$item</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getDepth</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line148"></a>        <span style="color: #009900;">&#125;</span>
<a name="line149"></a>        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span> instanceof \PHPCR\PropertyInterface<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line150"></a>            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">entering</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line151"></a>            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">leaving</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line152"></a>        <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span>
<a name="line153"></a>            try <span style="color: #009900;">&#123;</span>
<a name="line154"></a>                <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">breadthFirst</span> <span style="color: #339933;">===</span> <span style="color: #009900; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line155"></a>                    <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">entering</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line156"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">maxDepth</span> <span style="color: #339933;">==</span> <span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span> <span style="color: #339933;">||</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">&lt;</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">maxDepth</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line157"></a>                        <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #339933;">++;</span>
<a name="line158"></a>                        <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getProperties</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$property</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line159"></a>                            <span style="color: #000088;">$property</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">accept</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line160"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line161"></a>                        <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getNodes</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$node</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line162"></a>                            <span style="color: #000088;">$node</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">accept</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line163"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line164"></a>                        <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #339933;">--;</span>
<a name="line165"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line166"></a>                    <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">leaving</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line167"></a>                <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span>
<a name="line168"></a>                    <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">entering</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line169"></a>                    <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">leaving</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">,</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line170"></a>&nbsp;
<a name="line171"></a>                    <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">maxDepth</span> <span style="color: #339933;">==</span> <span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span> <span style="color: #339933;">||</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">&lt;</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">maxDepth</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line172"></a>                        <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getProperties</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$property</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line173"></a>                            <span style="color: #000088;">$property</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">accept</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line174"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line175"></a>                        <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$item</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getNodes</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$node</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line176"></a>                            <span style="color: #000088;">$node</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">accept</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line177"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line178"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line179"></a>&nbsp;
<a name="line180"></a>                    <span style="color: #b1b100;">while</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentQueue</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">isEmpty</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">||</span> <span style="color: #339933;">!</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">nextQueue</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">isEmpty</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line181"></a>                        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentQueue</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">isEmpty</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line182"></a>                            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span><span style="color: #339933;">++;</span>
<a name="line183"></a>                            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentQueue</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">nextQueue</span><span style="color: #339933;">;</span>
<a name="line184"></a>                            <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">nextQueue</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> \SplQueue<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line185"></a>                        <span style="color: #009900;">&#125;</span>
<a name="line186"></a>                        <span style="color: #000088;">$item</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentQueue</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">dequeue</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line187"></a>                        <span style="color: #000088;">$item</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">accept</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$this</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<a name="line188"></a>                    <span style="color: #009900;">&#125;</span>
<a name="line189"></a>                    <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
<a name="line190"></a>                <span style="color: #009900;">&#125;</span>
<a name="line191"></a>            <span style="color: #009900;">&#125;</span> catch <span style="color: #009900;">&#40;</span>\PHPCR\RepositoryException <span style="color: #000088;">$exception</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a name="line192"></a>                <span style="color: #000088;">$this</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">currentDepth</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
<a name="line193"></a>                <span style="color: #b1b100;">throw</span> <span style="color: #000088;">$exception</span><span style="color: #339933;">;</span>
<a name="line194"></a>            <span style="color: #009900;">&#125;</span>
<a name="line195"></a>        <span style="color: #009900;">&#125;</span>
<a name="line196"></a>    <span style="color: #009900;">&#125;</span>
<a name="line197"></a><span style="color: #009900;">&#125;</span>
<a name="line198"></a>&nbsp;</pre>
<div class="header">
<h1>PHPCR</h1>
<ul>
<li><a href="../../../overview-summary.html">Overview</a></li>
<li>Package</li><li>Class</li><li>Tree</li><li><a href="../../../overview-files.html">Files</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../todo-list.html">Todo</a></li>
<li><a href="../../../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../../../index.html" target="_top">Frames</a>
<a href="../../../source/phpcr/util/traversingitemvisitor.php.html" target="_top">No frames</a>
</div>
<hr>

<p id="footer">This document was generated by <a href="http://peej.github.com/phpdoctor/">PHPDoctor: The PHP Documentation Creator</a></p>

</body>

</html>